# /evolve - 知识演化技能

## 描述

从历史决策中学习并提取代码模式，触发知识进化流程，更新知识库和知识图谱。

## 使用方式

```
/evolve
/evolve --analyze-recent
/evolve --extract-patterns
/evolve --time-window <天数>
```

## 参数

- 无参数 - 执行完整的知识演化流程（学习 + 模式提取）
- `--analyze-recent` - 仅分析最近的决策（不扫描代码）
- `--extract-patterns` - 仅提取代码模式（不学习决策）
- `--time-window <天数>` - 指定学习的时间窗口（默认 7 天）

## 功能

此技能会执行以下操作：

### 1. 决策学习

- **加载历史决策** - 从记忆管理器加载决策记录
- **识别模式** - 分析决策中的重复模式
- **生成洞察** - 提取决策经验和教训
- **更新知识库** - 将学习结果添加到知识库

### 2. 代码模式提取

- **扫描代码库** - 分析项目代码结构
- **识别设计模式** - 检测常见设计模式（工厂、单例、装饰器等）
- **提取最佳实践** - 识别代码中的最佳实践
- **记录模式库** - 保存到 `.agent/knowledge/patterns.json`

### 3. 知识图谱更新

- **添加模式节点** - 将新识别的模式添加到知识图谱
- **添加洞察节点** - 将学习洞察添加到知识图谱
- **建立关联** - 连接相关的决策、模式和洞察

## 示例

### 示例 1：完整知识演化

```
/evolve
```

输出：

```
🚀 开始知识演化流程...

================================================================================
知识进化完成
================================================================================

时间戳: 2026-02-16T22:30:00

学习报告:
  - 识别模式: 12 个
  - 生成洞察: 8 个

模式统计:
  - 扫描文件: 156 个
  - 发现模式: 28 个

知识图谱:
  - 总节点数: 234
  - 总边数: 456
  - 新增模式节点: 28
  - 新增洞察节点: 8

演化摘要:
本次知识演化成功识别了 12 个决策模式和 28 个代码模式，
生成了 8 个有价值的洞察。知识图谱新增 36 个节点和 52 条边。

✅ 知识演化完成！
```

### 示例 2：仅分析最近决策

```
/evolve --analyze-recent
```

适用场景：快速学习最近的决策经验，不扫描代码库。

### 示例 3：仅提取代码模式

```
/evolve --extract-patterns
```

适用场景：代码库有重大更新，需要重新提取模式。

### 示例 4：指定时间窗口

```
/evolve --time-window 30
```

分析最近 30 天的决策记录。

## 识别的模式类型

### 决策模式

- **架构决策** - 系统架构选择
- **技术选型** - 技术栈和工具选择
- **问题解决** - 常见问题的解决方案
- **优化策略** - 性能和代码优化方法

### 代码模式

- **设计模式** - 工厂、单例、装饰器、观察者等
- **架构模式** - MVC、MVVM、分层架构等
- **最佳实践** - 命名规范、错误处理、日志记录等
- **反模式** - 需要避免的不良实践

## 输出

知识演化报告包含：

- **时间戳** - 演化执行时间
- **学习报告** - 识别的模式数和洞察数
- **模式统计** - 扫描文件数和发现模式数
- **知识图谱统计** - 节点数、边数、新增数量
- **演化摘要** - 本次演化的总结

## 注意事项

- 首次运行可能需要较长时间（取决于代码库大小）
- 建议定期运行（每周或每次重大更新后）
- 演化结果会自动保存到 `.agent/knowledge/` 目录
- 可以通过 `/patterns` 和 `/knowledge` 技能查询演化结果

## 性能建议

- 对于大型代码库（>1000 文件），建议使用 `--extract-patterns` 单独运行
- 可以通过配置文件指定扫描目录，避免扫描不必要的文件
- 演化过程会自动跳过 `node_modules`、`.git` 等目录

## 相关技能

- `/patterns` - 查看代码模式库
- `/knowledge` - 查询知识库
- `/reflect` - 生成反思报告
